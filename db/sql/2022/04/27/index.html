<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>index | Your awesome title</title>
<meta name="generator" content="Jekyll v4.2.2">
<meta property="og:title" content="index">
<meta name="author" content="GitHub User">
<meta property="og:locale" content="en_US">
<meta name="description" content="index">
<meta property="og:description" content="index">
<link rel="canonical" href="http://localhost:4000/db/sql/2022/04/27/">
<meta property="og:url" content="http://localhost:4000/db/sql/2022/04/27/">
<meta property="og:site_name" content="Your awesome title">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-04-27T00:00:00+09:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="index">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2022-04-27T00:00:00+09:00","datePublished":"2022-04-27T00:00:00+09:00","description":"index","headline":"index","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/db/sql/2022/04/27/"},"url":"http://localhost:4000/db/sql/2022/04/27/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Your awesome title">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



























































































































<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="Your awesome title" src="" onerror="this.style.display='none'">
  Your awesome title
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/">HOME</a><a class="page-link" href="/tags.html">TAGS</a>




<span class="page-link">

<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://cdn.countryflags.com/thumbs/france/flag-400.png" title="French">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://cdn.countryflags.com/thumbs/china/flag-400.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://cdn.countryflags.com/thumbs/japan/flag-400.png" title="Japanese">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://cdn.countryflags.com/thumbs/russia/flag-400.png" title="Russian">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: '',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  })();
</script>
















































































































































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">index</h1>
  <h2 class="post-subtitle"></h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2022-04-27T00:00:00+09:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Apr 27, 2022
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 7 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/tags.html#DB">#DB</a><a class="post-tag" href="/tags.html#sql">#sql</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="index">index</h2>

<p>index는 RDBMS 에서 검색 속도를 높이기 위한 기술이다.</p>

<p>테이블의 칼럼을 색인화(따로 파일로 저장) 하여 검색시 테이블의 레코드를 전부 스캔하는게 아니라 색인화된 인덱스 파일을 검색하여 검색속도를 빠르게 한다.</p>

<p>select 쿼리의 where 절이나 join 예약어를 사용했을때 사용디며 select 쿼리의 검색속도를 빠르게 하는데 목적을 두고 있다.(delete, insert, update 쿼리는 해당사항이 없으며 사용시 더 느려진다)</p>

<p>데이터의 레코드는 내부적으로 순서없이 저장되며 저장영역을 heap 이라고 한다.</p>

<p>heap 에서는 인덱스가 없는 테이블의 데이터를 찾을때 전체 데이터 페이지의 청므 레코드부터 끝페이지의 마지막 레코드 까지 모두 조회하여 검색조건과 비교하게 된다. -&gt; 테이블 스캔 또는 풀 스캔이라고 함</p>

<p>양이 많은 테이블에서 일부분의 데이터만 불러 올 때 풀 스캔을 하면 처리 성능이 떨어진다. -&gt; 즉 인덱스는 셀렉트를 할때 빨리 찾기 위해 사용된다.</p>

<h2 id="index-사용-이유">index 사용 이유</h2>

<ul>
  <li>
    <p>where 구문과 일치하는 열을 빨리 찾기 위해.</p>
  </li>
  <li>
    <p>특정 열을 고려 대상에서 빨리 없애 버리기 위해.</p>
  </li>
  <li>
    <p>조인을 실행할 떄 다른 테이블에서 열을 추출하기 위해.</p>
  </li>
  <li>
    <p>특정하게 인덱스딘 칼럼을 위한 min() 또는 max() 값을 찾기 위해.</p>
  </li>
  <li>
    <p>사용할 수 있는 키의 최 좌측 접두사를 가지고 정렬 및 그룹화를 하기 위해.</p>
  </li>
  <li>
    <p>데이터 열을 참조하지 않는 상태로 값을 추출하기 위해 쿼리를 최적화 하는 경우.</p>
  </li>
</ul>

<h2 id="b--tree-알고리즘">B- Tree 알고리즘</h2>

<ul>
  <li>
    <p>B+ Tree : index에 일반적으로 사용되며, 컬럼의 값을 변형하지않고(값의 앞부분만 잘라서 관리) 원래의 값을 이용해 인덱싱하는 알고리즘 이다.</p>
  </li>
  <li>
    <p>Hash : 컬럼의 값으로 해시 값을 계산해서 인덱싱 하는 알고리즘으로 매우 빠른 검색을 지원한다. 하지만 값을 변형해서 인덱싱 하므로, 특정 문자로 시작하는 값으로 검색하는 등의 전방 일치와 같이 일부분만으로 검색하고자 할 때는 해시 인덱스를 사용할 수 없다. 주로 메모리 기반 데이터베이스에 많이 사용한다.</p>
  </li>
</ul>

<p>데이터 접근에 시간 복잡도가 0(1) 인 hashtable 대신 B- Tree 사용하는 이유는 select 절 조건에 부등호 연산이 포함될 경우 문제가 발생한다. 
hashtable은 동등 연산에 특화되어있어 데이터베이스의 자료구조에 적합하지 않다.</p>

<h2 id="index-구조와-작동-원리">index 구조와 작동 원리</h2>

<h3 id="index-구조">index 구조</h3>

<p>index는 논리적/물리적으로 테이블과 독립적이다.</p>

<p>테이블은 칼럼에 데이터가 정렬되지 않고 입력된 순서대로 들어가지만, index는 key 칼럼과 rowid 칼럼 두개로 이루어져 있고 오름차순, 내림차순으로 정렬이 가능하다.</p>

<p>key :  인덱스를 생성하라고 지정한 칼럼의 값</p>

<p>mysql에서 테이블 생성시 , 3개지 파일이 생성된다.</p>

<ul>
  <li>
    <p>FRM: 테이블 구조 저장 파일</p>
  </li>
  <li>
    <p>MYD: 실제 데이터 파일</p>
  </li>
  <li>
    <p>MYI: index 정보 파일(index 사용 시 생성)</p>
  </li>
</ul>

<p>사용자가 쿼리를 통해 index를 사용하는 칼럼을 검색하게 되면, 이때 MYI 파일의 내용을 활용한다.</p>

<p>디스크 공간은 보통 테이블을 저장하는 데 필요한 디스크 공간보다 작다.</p>

<p>보통 인덱스는 KEY-ROWID만 가지고 있고, 테이블의 세부항목들은 작고 있지 않기 때문</p>

<h2 id="index-작동원리">index 작동원리</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * 
from emp
where empno = 7902;
</code></pre></div></div>

<p>데이터 파일 블록이 10만개 일 때, 위 sql 문을 수행시</p>

<p>1 서버 프로세스가 파싱 과정을 마친 후 DB buffer cache 에 empno 가 7902인 정보가 있는지 확인한다.</p>

<p>2 정보가 없으면 하드 디스크 파일에서 7902 정보를 가진 블록을 복사해서 DB buffer cache 로 가져온 후
7902 정보만 골라내서 사용자에게 보여준다.</p>

<p>이떄 두가지로 나누면</p>

<p>index 가 없는경우: 7902 가 어떤 블록에 들어 있는지 모르므로 10만개 전부 db buffer cache로 보가 후 하나 하나 찾는다.</p>

<p>index 가 있는 경우: where 절의 칼럼이 index가 만들어져 있는지 확인 후, 인덱스에 먼저 가서 7902  정보가 어떤 rowid를 가지고 있는지 확인한 후 해당 rowid에 있는 블록만 찾아가서 db buffer cache에 복사함.</p>

<h2 id="dml이-일어낫을-떄-상황">DML이 일어낫을 떄 상황</h2>

<ul>
  <li>insert</li>
</ul>

<p>기존 Block 에 여유가 없을 때, 새로운 data가 입력된다.</p>

<p>-&gt; 새로운 block을 할당 받은 후, key를 옮기는 작업을 수행</p>

<p>-&gt; index split 작업동안, 해당 block의 key 값에 대해서 DML이 블로킹 된다.
대기 이벤트 발생</p>

<ul>
  <li>delete</li>
</ul>

<table>
  <tbody>
    <tr>
      <td>table</td>
      <td>index</td>
    </tr>
    <tr>
      <td>data가 지워지고, 다른 data가 그 공간을 사용 가능하다.</td>
      <td>data가 지워지지 않고, 사용 안 됨 표시만 해둔다.</td>
    </tr>
  </tbody>
</table>

<p>table의 data 수와 index의 data 수가 다를 수 있다</p>

<ul>
  <li>update</li>
</ul>

<p>table에서 update가 발생하면 -&gt; index는 update 할 수 없다.
index에서는 delete가 발생한 후 , 새로운 작업의 insert 작업/ 2배의 작업이 소요되어 힘들다.</p>

<h2 id="index-종류">index 종류</h2>

<ul>
  <li>
    <p>clustered index : 물리적 정렬로 DB에 데이터를 입력 시 clustered 인덱스를 기준으로 입력하게 된다.
따라서 한테이블에 오직 하나만 존재할 수 있으며 table을 열었을 때 order by를 사용하지 않아도 clusterd 인덱스를 따라 정렬 되어 있는 것을 확인 할 수 있다.</p>
  </li>
  <li>
    <p>nonclusterd index : clustered 인덱스와 달리 중복된 값을 가지면 한 테이블에 여러 개를 생성 할 수 있다.
자동 정렬되지 않고, 인덱스 생성할 때는 clustered 되어있을 떄, 인덱스 스캔이 유리하다.</p>
  </li>
</ul>

<h2 id="index-장점">index 장점</h2>

<ul>
  <li>키 값을 기초로 하여 테이블에서 검색과 정렬 속도를 향상시킨다.</li>
  <li>질의나 보고서에서 그룹화 작업의 속도를 향상 시킨다.</li>
  <li>인덱스를 사용하면 테이블 행의 고유성을 강화시킬 수 있다.</li>
  <li>테이블의 기본 키는 자동으로 인덱스가 된다.</li>
</ul>

<h2 id="index-단점">index 단점</h2>

<ul>
  <li>index 생성시 .mdb 파일 크기가 증가한다.</li>
  <li>한 페이지를 동시에 수정할 수 있는 병행성이 줄어든다.</li>
  <li>데이터 변경 작업이 자주 일어나는 경우, index를 재작성해야 하므로 성능에 영향을 미친다.</li>
  <li>index를 생성하는데 시간이 많이 소요될 수 있다.</li>
  <li>index가 데이터베이스 공간을 차지해 추가적인 공간이 필요해진다.
(db 의 10퍼센트내외의 공간이 추가로 필요)</li>
</ul>

<h3 id="index를-남발하지-말아야-하는-이유">index를 남발하지 말아야 하는 이유</h3>

<p>데이터베이스 서버 성능에 문제가 발생하면 가장 빨리 생각나는 해결책이 인덱스 추가 생성이다.
하지만 문제 발생시마다 인덱스를 생성하면서 인덱스가 쌓여가는 것은 하나의 쿼리문을 빠르게 만들 수는 있겠지만
전체적인 데이터베이스 성능 부하를 초래한다.</p>

<p>조회 성능을 극대화하려 만든 객체이므로 많은 인덱스가 쌓이면 insert, delete, update 시에 부하가 발생하여 전체적인 데이터베이스 성능을 저해한다.</p>

<p>인덱스은 마지막 수단이고 좀 더 효율적인 sql문을 짜는방향성으로 나가야한다.</p>

<h2 id="index-사용-전-명시-사항">index 사용 전 명시 사항</h2>

<ul>
  <li>
    <p>where 절에서 자주 사용하는 칼럼에 사용</p>
  </li>
  <li>
    <p>like ‘%~’는 조심해야한다 %는 뒤에만 사용하도록 해야한다. (table scan 이여서 성능 감소)</p>
  </li>
  <li>
    <p>between A and B (Clustered index가 유리)
범위 쿼리문에서는 클러스터 인덱스가 유리하지만 클러스터 인덱스는 테이블당 1개만 가질 수 있다는 단점이 존재</p>
  </li>
  <li>
    <p>order by에 항상 또는 자주 사용되는 칼럼에 사용한다.</p>
  </li>
  <li>
    <p>join으로 자주 사용되는 칼럼에 사용한다.</p>
  </li>
  <li>
    <p>foreign key (1:1 매핑)이 많을 때 -&gt; clustered, nonclustered index 둘다 상관 없다.
상황에 따라 clustered index 사용</p>
  </li>
  <li>
    <p>1000만 건중의 데이터중 10 건의 데이터 조회 -&gt; 찾는 건이 적은 칼럼에 index를 사용한다.
상책중복이 많은 칼럼(ex: 성별)에는 index를 거는 것이 아니다.
조회되는 건 수가 많으면 인덱스를 걸지 않고 table scan이 더 나은편이다.</p>
  </li>
  <li>
    <p>not 연산자는 긍정문으로 변경</p>
  </li>
  <li>
    <p>insert, delete 등 데이터의 변경(dml)이 많은 칼럼은 인덱스를 걸지 않는 편이 좋다.</p>
  </li>
  <li>
    <p>인덱스를 만드는데 시간과 저장공간이 소비되고 만들고 난 후에도 추가적인 공간이 필요하다.</p>
  </li>
  <li>
    <p>데이터를 변경(insert, update, delete)을 하면 인덱스를 다시 조정해야 하기 때문에 자원이 ㅁ낳이 소모된다. 특히 insert 연산</p>
  </li>
</ul>

<h2 id="index-사용-예">index 사용 예</h2>

<ul>
  <li>인덱스 생성</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create index 인덱스명 on 테이블명 (칼럼1,칼럼2,칼럼3....);
//unique 키워드를 붙이면 칼럼값에 중복값을 허용하지 않는다는 뜻

alter table 테이블명 add index(필드명(크기);

create table 테이블명 (필드명 데이터타입(크기), index(칼럼명(크기)) engine myISAM;
</code></pre></div></div>

<p>필드 중에는 데이ㅓ 형식 때문에 인덱스가 될 수 없는 필드도 있다.</p>

<p>여러 필드로 이루어진(다중 필드) 인덱스를 사용하면 첫 필드 값이 같은 레코드도 구분할 수 있다.</p>

<p>액세스에서 다중 필드 인덱스는 최대 10개의 필드르 포함할 수 있다.</p>

<ul>
  <li>인덱스 삭제</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>drop index 인덱스명
</code></pre></div></div>

<ul>
  <li>인덱스 확인</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>show index from 테이블이름
</code></pre></div></div>

<h2 id="인덱스-리빌드">인덱스 리빌드</h2>

<p>인덱스 리빌드를 하는 이유는 인덱스 파일 생성후 dml을 반복하다보면 성능이 저하된다.</p>

<p>생성된 인덱스는 트리구조를 가지는데 삽입, 수정, 삭제들이 오랫동안 일어나다보면 트리의 한쪽이 무거워져 전체적으로 트리의 깊이가 깊어지기 때문이다. -&gt; 인덱스 검색속도가 떨어지므로 주기적으로 리빌딩 작업을 거치는게 좋다.</p>

<ul>
  <li>인덱스 리빌드</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>alter index 인덱스명 rebulid;
</code></pre></div></div>

<ul>
  <li>전체 인덱스 리빌드 쿼리문</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select 'alter index' \||인덱스명\||' rebulid; ' from USER\_INDEXES;
</code></pre></div></div>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/java/springboot/2022/04/27/framework-library.html" title="프레임워크와 라이브러리">프레임워크와 라이브러리</a><span></span>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/jekyll/ruby/git/2022/04/08/gitblog.html" title="">git 블로그 만들기</a></li>
<li><a class="post-link" href="/junk/2017/05/20/this-post-demonstrates-post-content-styles.html" title="">This post demonstrates post content styles</a></li>
<li><a class="post-link" href="/markdown/2018/05/26/mathjax-test.html" title="">Mathjax Test</a></li>
<li><a class="post-link" href="/node.js/2022/04/13/node.html" title="">node.js 와 npm</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">목록</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
      <div>Copyright © 1970-2010 @GitHub User</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="http://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
